version: '3'
services:
 mysql:
   image: mysql:5.7
   env_file: ./mysql/mysql.env
   environment:
     - TZ=Asia/Tokyo
   ports:
     - '3306:3306'
   volumes:
     - ./mysql/conf:/etc/mysql/conf.d/:ro
     - mysqldata:/var/lib/mysql
   networks:
     - default
 api:
   image: node:12
   env_file: ./api.env
   environment:
     - TZ=Asia/Tokyo
     - DEBUG=app:*
   tty: true
   ports:
     - '3000:3000'
   volumes:
     - ./api:/app
   working_dir: /app
   command: npm run watch
   networks:
     - default
   depends_on:
     - mysql
 web:
   image: node:12
   environment:
     - TZ=Asia/Tokyo
     - DEBUG=app:*
   tty: true
   ports:
     - '3001:3000'
   volumes:
     - ./web:/app
   working_dir: /app
   command: npm run start
   networks:
     - default
networks:
 default:

volumes:
 mysqldata: